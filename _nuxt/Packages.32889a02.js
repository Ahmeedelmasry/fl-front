import{k as v,r as c,o as R,c as G,b as o,w as s,h as I,j as e,g as F,D as ae,E as O,G as w,H as q,s as B,f as oe,z as se,l as Q,d as b,t as H,q as le,a as T,n as ne}from"./entry.08c37509.js";import{V as W}from"./VDataTable.cbb22240.js";import{d as re}from"./tests.bc82165a.js";import{d as ie}from"./categories.e862bb22.js";import{r as N,m as L,n as Y,b as K,u as z}from"./index.4590c98c.js";import{_ as de}from"./DeletePopup.f158edf7.js";const ce={class:"nested_tests"},ue={__name:"NestedVisits",props:["tests"],setup(m){const d=v([{title:"Name",key:"nameEN"},{title:"Price",key:"price"},{title:"discount",key:"discount"},{title:"Category",key:"category.nameEN"}]);return(l,P)=>{const h=c("v-card");return R(),G("div",ce,[o(h,null,{default:s(()=>[m.tests?(R(),I(e(W),{key:0,headers:e(d),items:m.tests},null,8,["headers","items"])):F("",!0)]),_:1})])}}},pe=ue,X=ae("dashboardPackageStore",{state:()=>({dashboardPackages:[]}),actions:{async doGetDashboardPackages(){this.dashboardPackages=[],await O.get(`${w().apiURL}/FutureLab/package?lang=${q().lang[0]}`).then(m=>{this.dashboardPackages=m.data})},async doAddDashboardPackages(m){let d;return await O({data:m,method:"POST",url:`${w().apiURL}/FutureLab/package?lang=${q().lang[0]}`}).then(l=>{d=!0,this.dashboardPackages=l.data,w().callResponse(!0,l.data.message,1)}).catch(l=>{d=!1,w().callResponse(!0,l.response.data.message,2)}),d},async doUpdateDashboardPackages(m){let d;return await O({data:m,method:"PATCH",url:`${w().apiURL}/FutureLab/package?lang=${q().lang[0]}`}).then(l=>{d=!0,this.dashboardPackages=l.data,w().callResponse(!0,l.data.message,1)}).catch(l=>{w().callResponse(!0,l.response.data.message,2),d=!1}),d}}}),me={class:"update_banner"},ge={class:"actions text-center"},_e={__name:"UpdatePackage",props:["openPopup","toUpdate"],emits:["closePopup","regetData"],setup(m,{emit:d}){const l=m,P=re(),h=X(),U=ie(),{dashboardTests:$}=B(P),{dashboardCategories:E}=B(U),a=v({titleEN:"",titleAR:"",descriptionEN:"",descriptionAR:"",price:"",discount:"",tests:[],image:null,category:""}),k=v(!1),g=v(!1),f=v(!1),M=v(null),y=v({titleEN:{required:N,minLength:L(3)},titleAR:{required:N,minLength:L(3)},descriptionEN:{required:N,minLength:L(3)},descriptionAR:{required:N,minLength:L(3)},price:{required:N,numeric:Y,between:K(1,1e5)},discount:{required:N,numeric:Y,between:K(0,90)},tests:{required:N,minLength:L(2)},image:{required:N,minLength:L(1)},category:{required:N}}),_=oe(()=>$.value&&$.value.content?$.value.content:[]);se(()=>k.value,A=>{A||setTimeout(()=>{d("closePopup")},200)});let r=z(y,a);const j=async()=>{if(l.toUpdate&&(y.value.image={},r=z(y,a)),await r.value.$validate()){g.value=!0;const n=a.value.tests.map(u=>u={id:u});if(l.toUpdate){const u=new FormData;if(u.append("stringDto",JSON.stringify({id:l.toUpdate.selectable.id,titleEN:a.value.titleEN,titleAR:a.value.titleAR,descriptionEN:a.value.descriptionEN,descriptionAR:a.value.descriptionAR,price:a.value.price,discount:a.value.discount,tests:n,category:{id:a.value.category}})),a.value.image&&a.value.image.length)u.append("photo",a.value.image[0]);else{const p=atob(M.value),C=new ArrayBuffer(p.length),x=new Uint8Array(C);for(let D=0;D<p.length;D++)x[D]=p.charCodeAt(D);const S=new Blob([C],{type:"application/octet-stream"}),i=new File([S],"filename.ext",{type:"application/octet-stream"});u.append("photo",i)}await h.doUpdateDashboardPackages(u)&&(d("regetData"),k.value=!1)}else{const u=new FormData;u.append("stringDto",JSON.stringify({titleEN:a.value.titleEN,titleAR:a.value.titleAR,descriptionEN:a.value.descriptionEN,descriptionAR:a.value.descriptionAR,price:a.value.price,discount:a.value.discount,category:{id:a.value.category},tests:n})),u.append("photo",a.value.image[0]),await h.doAddDashboardPackages(u)&&(d("regetData"),k.value=!1)}g.value=!1}};return Q(async()=>{k.value=l.openPopup,f.value=!0,await Promise.all([U.doGetDashboardCategories(),P.doGetDashboardTests()]),l.toUpdate&&(a.value.titleEN=l.toUpdate.selectable.titleEN,a.value.titleAR=l.toUpdate.selectable.titleAR,a.value.descriptionEN=l.toUpdate.selectable.descriptionEN,a.value.descriptionAR=l.toUpdate.selectable.descriptionAR,a.value.discount=l.toUpdate.selectable.discount,a.value.price=l.toUpdate.selectable.price,a.value.category=l.toUpdate.selectable.category.id,M.value=l.toUpdate.selectable.photo,l.toUpdate.selectable.tests.forEach(A=>a.value.tests.push(A.id)),r=z(y,a)),f.value=!1}),(A,n)=>{const u=c("v-card-title"),V=c("v-text-field"),p=c("v-col"),C=c("v-textarea"),x=c("v-select"),S=c("v-file-input"),i=c("v-row"),D=c("v-container"),J=c("v-btn"),Z=c("v-form"),ee=c("v-card"),te=c("v-dialog");return R(),G("div",me,[o(te,{modelValue:e(k),"onUpdate:modelValue":n[10]||(n[10]=t=>ne(k)?k.value=t:null),width:"700",persistent:""},{default:s(()=>[o(ee,null,{default:s(()=>[o(u,{class:"mb-5 text-center bg-grey-lighten-3"},{default:s(()=>[b(H(m.toUpdate?"Update Package":"Add Package"),1)]),_:1}),o(Z,{class:"pa-5",onSubmit:le(j,["prevent"])},{default:s(()=>[o(D,null,{default:s(()=>[o(i,null,{default:s(()=>[o(p,{cols:"12",sm:"6"},{default:s(()=>[o(V,{label:"English Package Name",variant:"outlined",disabled:e(g)||e(f),modelValue:e(a).titleEN,"onUpdate:modelValue":n[0]||(n[0]=t=>e(a).titleEN=t),"error-messages":e(r).$errors.find(t=>t.$property=="titleEN")?e(r).$errors.find(t=>t.$property=="titleEN").$message:""},null,8,["disabled","modelValue","error-messages"])]),_:1}),o(p,{cols:"12",sm:"6"},{default:s(()=>[o(V,{label:"Arabic Package Name",variant:"outlined",disabled:e(g)||e(f),modelValue:e(a).titleAR,"onUpdate:modelValue":n[1]||(n[1]=t=>e(a).titleAR=t),"error-messages":e(r).$errors.find(t=>t.$property=="titleAR")?e(r).$errors.find(t=>t.$property=="titleAR").$message:""},null,8,["disabled","modelValue","error-messages"])]),_:1}),o(p,{cols:"12",sm:"6"},{default:s(()=>[o(C,{label:"English Package Description",disabled:e(g)||e(f),variant:"outlined",modelValue:e(a).descriptionEN,"onUpdate:modelValue":n[2]||(n[2]=t=>e(a).descriptionEN=t),"error-messages":e(r).$errors.find(t=>t.$property=="descriptionEN")?e(r).$errors.find(t=>t.$property=="descriptionEN").$message:"",rows:"3"},null,8,["disabled","modelValue","error-messages"])]),_:1}),o(p,{cols:"12",sm:"6"},{default:s(()=>[o(C,{label:"Arabic Package Description",disabled:e(g)||e(f),variant:"outlined",modelValue:e(a).descriptionAR,"onUpdate:modelValue":n[3]||(n[3]=t=>e(a).descriptionAR=t),"error-messages":e(r).$errors.find(t=>t.$property=="descriptionAR")?e(r).$errors.find(t=>t.$property=="descriptionAR").$message:"",rows:"3"},null,8,["disabled","modelValue","error-messages"])]),_:1}),o(p,{cols:"12",sm:"6"},{default:s(()=>[o(V,{label:"Package Price",variant:"outlined",disabled:e(g)||e(f),modelValue:e(a).price,"onUpdate:modelValue":n[4]||(n[4]=t=>e(a).price=t),"error-messages":e(r).$errors.find(t=>t.$property=="price")?e(r).$errors.find(t=>t.$property=="price").$message:""},null,8,["disabled","modelValue","error-messages"])]),_:1}),o(p,{cols:"12",sm:"6"},{default:s(()=>[o(V,{label:"Package Discount",variant:"outlined",disabled:e(g)||e(f),modelValue:e(a).discount,"onUpdate:modelValue":n[5]||(n[5]=t=>e(a).discount=t),"error-messages":e(r).$errors.find(t=>t.$property=="discount")?e(r).$errors.find(t=>t.$property=="discount").$message:""},null,8,["disabled","modelValue","error-messages"])]),_:1}),o(p,{cols:"12",sm:"6"},{default:s(()=>[o(x,{items:e(E).content,"item-title":"nameEN",variant:"outlined","item-value":"id",disabled:e(f)||e(g),label:"Select Category",modelValue:e(a).category,"onUpdate:modelValue":n[6]||(n[6]=t=>e(a).category=t),"error-messages":e(r).$errors.find(t=>t.$property=="category")?e(r).$errors.find(t=>t.$property=="category").$message:""},null,8,["items","disabled","modelValue","error-messages"])]),_:1}),o(p,{cols:"12",sm:"6"},{default:s(()=>[o(S,{modelValue:e(a).image,"onUpdate:modelValue":n[7]||(n[7]=t=>e(a).image=t),variant:"outlined",label:"Package Image",disabled:e(f)||e(g),accept:".jpg, .jpeg, png","error-messages":e(r).$errors.find(t=>t.$property=="image")?e(r).$errors.find(t=>t.$property=="image").$message:""},null,8,["modelValue","disabled","error-messages"])]),_:1}),o(p,{cols:"12"},{default:s(()=>[o(x,{items:e(_),"item-title":"nameEN",variant:"outlined","item-value":"id",disabled:e(g)||e(f),label:"Select Tests",modelValue:e(a).tests,"onUpdate:modelValue":n[8]||(n[8]=t=>e(a).tests=t),multiple:"",chips:"","error-messages":e(r).$errors.find(t=>t.$property=="tests")?e(r).$errors.find(t=>t.$property=="tests").$message:""},null,8,["items","disabled","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),T("div",ge,[o(J,{color:"red",class:"mr-3",onClick:n[9]||(n[9]=t=>k.value=!1),disabled:e(g)},{default:s(()=>[b("Cancel")]),_:1},8,["disabled"]),o(J,{color:"green",type:"submit",loading:e(g)},{default:s(()=>[b("Save")]),_:1},8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}}},ve=_e,fe={class:"dashboard_banners_listing"},be={class:"heading d-flex justify-space-between align-center"},he=T("h2",{class:"my-3"},"Test Packages",-1),ye={class:"py-3"},$e=["src"],ke={class:"d-flex align-center justify-center flex-column"},Pe={__name:"Listing",props:["dashboardPackages","loading"],emits:["regetData"],setup(m,{emit:d}){const l=w(),{LOCAL_HOST:P}=B(l),h=v(!1),U=v(!1),$=v(!1),E=v(null),a=v(null),k=v([{title:"Title EN",key:"titleEN"},{title:"Title AR",key:"titleAR"},{title:"Description EN",key:"descriptionEN"},{title:"Description AR",key:"descriptionAR"},{title:"Price",key:"price"},{title:"Tests",key:"Tests"},{title:"Image",key:"photo"},{title:"Actions",key:"actions"}]),g=y=>y?"green":"red",f=async()=>{$.value=!1,a.value.loading=!0,await l.doDeleteItem("package",a.value.id)&&d("regetData"),a.value.loading=!1},M=y=>{const _=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(`${P.value}/en/PackagesPage`)}&title=${encodeURIComponent(y.nameEN)}&description=${encodeURIComponent(y.price)}`;window.open(_,"_blank","width=600,height=400")};return(y,_)=>{const r=c("v-btn"),j=c("v-col"),A=c("v-row"),n=c("v-chip"),u=c("v-icon"),V=pe,p=c("v-tooltip"),C=c("v-container"),x=ve,S=de;return R(),G("div",fe,[o(C,{fluid:""},{default:s(()=>[o(A,null,{default:s(()=>[o(j,{cols:"12"},{default:s(()=>[T("div",be,[he,o(r,{onClick:_[0]||(_[0]=i=>h.value=!0),width:"150px",height:"45px",color:"blue"},{default:s(()=>[b("Add Package")]),_:1})])]),_:1})]),_:1}),m.dashboardPackages?(R(),I(A,{key:0,class:"px-4"},{default:s(()=>[o(j,{cols:"12",class:"section_container dashboard_table"},{default:s(()=>[o(e(W),{headers:e(k),items:m.dashboardPackages.content,loading:m.loading,search:""},{"item.photo":s(({item:i})=>[T("div",ye,[T("img",{width:"100",height:"70",style:{"border-radius":"10px"},src:i.selectable.photo?`data:image/jpg;base64,${i.selectable.photo}`:"",alt:"Test Image"},null,8,$e)])]),"item.latest":s(({item:i})=>[o(n,{color:g(i.selectable.latest)},{default:s(()=>[b(H(i.selectable.latest?"Yes":"No"),1)]),_:2},1032,["color"])]),"item.promoted":s(({item:i})=>[o(n,{color:g(i.selectable.promoted)},{default:s(()=>[b(H(i.selectable.promoted?"Yes":"No"),1)]),_:2},1032,["color"])]),"item.Tests":s(({item:i})=>[T("span",null,[o(u,{style:{cursor:"pointer"},color:"green"},{default:s(()=>[b("mdi-eye ")]),_:1}),o(p,{activator:"parent"},{default:s(()=>[o(V,{tests:i.selectable.tests},null,8,["tests"])]),_:2},1024)])]),"item.actions":s(({item:i})=>[T("div",ke,[o(r,{elevation:"0",onClick:D=>(E.value=i,U.value=!0)},{default:s(()=>[o(u,{color:"blue"},{default:s(()=>[b("mdi-square-edit-outline")]),_:1}),o(p,{activator:"parent",location:"bottom center"},{default:s(()=>[b("Update")]),_:1})]),_:2},1032,["onClick"]),o(r,{elevation:"0",color:"transparent",ripple:!1},{default:s(()=>[o(u,{color:"green",style:{cursor:"pointer"},onClick:D=>M(i.selectable),size:"23",id:`menu_activator_${i.selectable.id}`},{default:s(()=>[b("mdi-share-variant-outline")]),_:2},1032,["onClick","id"]),o(p,{activator:"parent",location:"bottom center"},{default:s(()=>[b("Share")]),_:1})]),_:2},1024),o(r,{elevation:"0",color:"transparent",loading:i.selectable.loading,ripple:!1},{default:s(()=>[o(u,{color:"red",style:{cursor:"pointer"},size:"23",onClick:D=>(a.value=i.selectable,$.value=!0)},{default:s(()=>[b("mdi-delete")]),_:2},1032,["onClick"]),o(p,{activator:"parent",location:"bottom center"},{default:s(()=>[b("Delete")]),_:1})]),_:2},1032,["loading"])])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1})):F("",!0)]),_:1}),e(U)?(R(),I(x,{key:0,openPopup:e(U),onClosePopup:_[1]||(_[1]=i=>(U.value=!1,E.value=null)),toUpdate:e(E),onRegetData:_[2]||(_[2]=i=>d("regetData"))},null,8,["openPopup","toUpdate"])):F("",!0),e(h)?(R(),I(x,{key:1,openPopup:e(h),onClosePopup:_[3]||(_[3]=i=>h.value=!1),onRegetData:_[4]||(_[4]=i=>d("regetData"))},null,8,["openPopup"])):F("",!0),e($)?(R(),I(S,{key:2,openPopup:e($),onClosePopup:_[5]||(_[5]=i=>$.value=!1),onConfirmDelete:f},null,8,["openPopup"])):F("",!0)])}}},De=Pe,Ne={class:"dashboard_tests_page"},Ce={__name:"Packages",setup(m){const d=X(),{dashboardPackages:l}=B(d),P=v(!0),h=async()=>{P.value=!0,await d.doGetDashboardPackages(),P.value=!1};return Q(()=>{h()}),(U,$)=>{const E=De;return R(),G("div",Ne,[o(E,{dashboardPackages:e(l),loading:e(P),onRegetData:h},null,8,["dashboardPackages","loading"])])}}};export{Ce as default};
