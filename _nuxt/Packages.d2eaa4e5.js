import{k as f,r as c,o as N,c as G,b as s,w as o,h as S,j as e,g as M,D as ae,E as I,G as U,H as q,s as z,f as se,z as oe,l as Q,d as D,t as H,q as le,a as T,n as ne}from"./entry.8c88b42c.js";import{V as W}from"./VDataTable.7c3107fa.js";import{d as re}from"./tests.14a191c6.js";import{d as ie}from"./categories.e9d8b0b4.js";import{r as P,m as C,n as Y,b as K,u as O}from"./index.a1c7dcf5.js";import{_ as de}from"./DeletePopup.ea62822f.js";const ce={class:"nested_tests"},ue={__name:"NestedVisits",props:["tests"],setup(u){const d=f([{title:"Name",key:"nameEN"},{title:"Price",key:"price"},{title:"discount",key:"discount"},{title:"Category",key:"category.nameEN"}]);return(l,b)=>{const y=c("v-card");return N(),G("div",ce,[s(y,null,{default:o(()=>[u.tests?(N(),S(e(W),{key:0,headers:e(d),items:u.tests},null,8,["headers","items"])):M("",!0)]),_:1})])}}},pe=ue,X=ae("dashboardPackageStore",{state:()=>({dashboardPackages:[]}),actions:{async doGetDashboardPackages(){this.dashboardPackages=[],await I.get(`${U().apiURL}/FutureLab/package?lang=${q().lang[0]}`).then(u=>{this.dashboardPackages=u.data})},async doAddDashboardPackages(u){let d;return await I({data:u,method:"POST",url:`${U().apiURL}/FutureLab/package?lang=${q().lang[0]}`}).then(l=>{d=!0,this.dashboardPackages=l.data,U().callResponse(!0,l.data.message,1)}).catch(l=>{d=!1,U().callResponse(!0,l.response.data.message,2)}),d},async doUpdateDashboardPackages(u){let d;return await I({data:u,method:"PATCH",url:`${U().apiURL}/FutureLab/package?lang=${q().lang[0]}`}).then(l=>{d=!0,this.dashboardPackages=l.data,U().callResponse(!0,l.data.message,1)}).catch(l=>{U().callResponse(!0,l.response.data.message,2),d=!1}),d}}}),me={class:"update_banner"},ge={class:"actions text-center"},_e={__name:"UpdatePackage",props:["openPopup","toUpdate"],emits:["closePopup","regetData"],setup(u,{emit:d}){const l=u,b=re(),y=X(),h=ie(),{dashboardTests:A}=z(b),{dashboardCategories:R}=z(h),a=f({titleEN:"",titleAR:"",descriptionEN:"",descriptionAR:"",price:"",discount:"",tests:[],image:null,category:""}),$=f(!1),m=f(!1),g=f(!1),_=f(null),E=f({titleEN:{required:P,minLength:C(3)},titleAR:{required:P,minLength:C(3)},descriptionEN:{required:P,minLength:C(3)},descriptionAR:{required:P,minLength:C(3)},price:{required:P,numeric:Y,between:K(1,1e5)},discount:{required:P,numeric:Y,between:K(0,90)},tests:{required:P,minLength:C(2)},image:{required:P,minLength:C(1)},category:{required:P}}),B=se(()=>A.value&&A.value.content?A.value.content:[]);oe(()=>$.value,k=>{k||setTimeout(()=>{d("closePopup")},200)});let i=O(E,a);const F=async()=>{if(l.toUpdate&&(E.value.image={},i=O(E,a)),await i.value.$validate()){m.value=!0;const n=a.value.tests.map(v=>v={id:v});if(l.toUpdate){const v=new FormData;if(v.append("stringDto",JSON.stringify({id:l.toUpdate.selectable.id,titleEN:a.value.titleEN,titleAR:a.value.titleAR,descriptionEN:a.value.descriptionEN,descriptionAR:a.value.descriptionAR,price:a.value.price,discount:a.value.discount,tests:n,category:{id:a.value.category}})),a.value.image&&a.value.image.length)v.append("photo",a.value.image[0]);else{const p=atob(_.value),w=new ArrayBuffer(p.length),r=new Uint8Array(w);for(let x=0;x<p.length;x++)r[x]=p.charCodeAt(x);const L=new Blob([w],{type:"application/octet-stream"}),j=new File([L],"filename.ext",{type:"application/octet-stream"});v.append("photo",j)}await y.doUpdateDashboardPackages(v)&&(d("regetData"),$.value=!1)}else{const v=new FormData;v.append("stringDto",JSON.stringify({titleEN:a.value.titleEN,titleAR:a.value.titleAR,descriptionEN:a.value.descriptionEN,descriptionAR:a.value.descriptionAR,price:a.value.price,discount:a.value.discount,category:{id:a.value.category},tests:n})),v.append("photo",a.value.image[0]),await y.doAddDashboardPackages(v)&&(d("regetData"),$.value=!1)}m.value=!1}};return Q(async()=>{$.value=l.openPopup,g.value=!0,await Promise.all([h.doGetDashboardCategories(),b.doGetDashboardTests()]),l.toUpdate&&(a.value.titleEN=l.toUpdate.selectable.titleEN,a.value.titleAR=l.toUpdate.selectable.titleAR,a.value.descriptionEN=l.toUpdate.selectable.descriptionEN,a.value.descriptionAR=l.toUpdate.selectable.descriptionAR,a.value.discount=l.toUpdate.selectable.discount,a.value.price=l.toUpdate.selectable.price,a.value.category=l.toUpdate.selectable.category.id,_.value=l.toUpdate.selectable.photo,l.toUpdate.selectable.tests.forEach(k=>a.value.tests.push(k.id)),i=O(E,a)),g.value=!1}),(k,n)=>{const v=c("v-card-title"),V=c("v-text-field"),p=c("v-col"),w=c("v-textarea"),r=c("v-select"),L=c("v-file-input"),j=c("v-row"),x=c("v-container"),J=c("v-btn"),Z=c("v-form"),ee=c("v-card"),te=c("v-dialog");return N(),G("div",me,[s(te,{modelValue:e($),"onUpdate:modelValue":n[10]||(n[10]=t=>ne($)?$.value=t:null),width:"700",persistent:""},{default:o(()=>[s(ee,null,{default:o(()=>[s(v,{class:"mb-5 text-center bg-grey-lighten-3"},{default:o(()=>[D(H(u.toUpdate?"Update Package":"Add Package"),1)]),_:1}),s(Z,{class:"pa-5",onSubmit:le(F,["prevent"])},{default:o(()=>[s(x,null,{default:o(()=>[s(j,null,{default:o(()=>[s(p,{cols:"12",sm:"6"},{default:o(()=>[s(V,{label:"English Package Name",variant:"outlined",disabled:e(m)||e(g),modelValue:e(a).titleEN,"onUpdate:modelValue":n[0]||(n[0]=t=>e(a).titleEN=t),"error-messages":e(i).$errors.find(t=>t.$property=="titleEN")?e(i).$errors.find(t=>t.$property=="titleEN").$message:""},null,8,["disabled","modelValue","error-messages"])]),_:1}),s(p,{cols:"12",sm:"6"},{default:o(()=>[s(V,{label:"Arabic Package Name",variant:"outlined",disabled:e(m)||e(g),modelValue:e(a).titleAR,"onUpdate:modelValue":n[1]||(n[1]=t=>e(a).titleAR=t),"error-messages":e(i).$errors.find(t=>t.$property=="titleAR")?e(i).$errors.find(t=>t.$property=="titleAR").$message:""},null,8,["disabled","modelValue","error-messages"])]),_:1}),s(p,{cols:"12",sm:"6"},{default:o(()=>[s(w,{label:"English Package Description",disabled:e(m)||e(g),variant:"outlined",modelValue:e(a).descriptionEN,"onUpdate:modelValue":n[2]||(n[2]=t=>e(a).descriptionEN=t),"error-messages":e(i).$errors.find(t=>t.$property=="descriptionEN")?e(i).$errors.find(t=>t.$property=="descriptionEN").$message:"",rows:"3"},null,8,["disabled","modelValue","error-messages"])]),_:1}),s(p,{cols:"12",sm:"6"},{default:o(()=>[s(w,{label:"Arabic Package Description",disabled:e(m)||e(g),variant:"outlined",modelValue:e(a).descriptionAR,"onUpdate:modelValue":n[3]||(n[3]=t=>e(a).descriptionAR=t),"error-messages":e(i).$errors.find(t=>t.$property=="descriptionAR")?e(i).$errors.find(t=>t.$property=="descriptionAR").$message:"",rows:"3"},null,8,["disabled","modelValue","error-messages"])]),_:1}),s(p,{cols:"12",sm:"6"},{default:o(()=>[s(V,{label:"Package Price",variant:"outlined",disabled:e(m)||e(g),modelValue:e(a).price,"onUpdate:modelValue":n[4]||(n[4]=t=>e(a).price=t),"error-messages":e(i).$errors.find(t=>t.$property=="price")?e(i).$errors.find(t=>t.$property=="price").$message:""},null,8,["disabled","modelValue","error-messages"])]),_:1}),s(p,{cols:"12",sm:"6"},{default:o(()=>[s(V,{label:"Package Discount",variant:"outlined",disabled:e(m)||e(g),modelValue:e(a).discount,"onUpdate:modelValue":n[5]||(n[5]=t=>e(a).discount=t),"error-messages":e(i).$errors.find(t=>t.$property=="discount")?e(i).$errors.find(t=>t.$property=="discount").$message:""},null,8,["disabled","modelValue","error-messages"])]),_:1}),s(p,{cols:"12",sm:"6"},{default:o(()=>[s(r,{items:e(R).content,"item-title":"nameEN",variant:"outlined","item-value":"id",disabled:e(g)||e(m),label:"Select Category",modelValue:e(a).category,"onUpdate:modelValue":n[6]||(n[6]=t=>e(a).category=t),"error-messages":e(i).$errors.find(t=>t.$property=="category")?e(i).$errors.find(t=>t.$property=="category").$message:""},null,8,["items","disabled","modelValue","error-messages"])]),_:1}),s(p,{cols:"12",sm:"6"},{default:o(()=>[s(L,{modelValue:e(a).image,"onUpdate:modelValue":n[7]||(n[7]=t=>e(a).image=t),variant:"outlined",label:"Package Image",disabled:e(g)||e(m),accept:".jpg, .jpeg, png","error-messages":e(i).$errors.find(t=>t.$property=="image")?e(i).$errors.find(t=>t.$property=="image").$message:""},null,8,["modelValue","disabled","error-messages"])]),_:1}),s(p,{cols:"12"},{default:o(()=>[s(r,{items:e(B),"item-title":"nameEN",variant:"outlined","item-value":"id",disabled:e(m)||e(g),label:"Select Tests",modelValue:e(a).tests,"onUpdate:modelValue":n[8]||(n[8]=t=>e(a).tests=t),multiple:"",chips:"","error-messages":e(i).$errors.find(t=>t.$property=="tests")?e(i).$errors.find(t=>t.$property=="tests").$message:""},null,8,["items","disabled","modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),T("div",ge,[s(J,{color:"red",class:"mr-3",onClick:n[9]||(n[9]=t=>$.value=!1),disabled:e(m)},{default:o(()=>[D("Cancel")]),_:1},8,["disabled"]),s(J,{color:"green",type:"submit",loading:e(m)},{default:o(()=>[D("Save")]),_:1},8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}}},ve=_e,fe={class:"dashboard_banners_listing"},be={class:"heading d-flex justify-space-between align-center"},ye=T("h2",{class:"my-3"},"Test Packages",-1),$e={class:"py-3"},he=["src"],ke={__name:"Listing",props:["dashboardPackages","loading"],emits:["regetData"],setup(u,{emit:d}){const l=U(),b=f(!1),y=f(!1),h=f(!1),A=f(null),R=f(null),a=f([{title:"Title EN",key:"titleEN"},{title:"Title AR",key:"titleAR"},{title:"Description EN",key:"descriptionEN"},{title:"Description AR",key:"descriptionAR"},{title:"Price",key:"price"},{title:"Tests",key:"Tests"},{title:"Image",key:"photo"},{title:"Actions",key:"actions"}]),$=g=>g?"green":"red",m=async()=>{h.value=!1,R.value.loading=!0,await l.doDeleteItem("package",R.value.id)&&d("regetData"),R.value.loading=!1};return(g,_)=>{const E=c("v-btn"),B=c("v-col"),i=c("v-row"),F=c("v-chip"),k=c("v-icon"),n=pe,v=c("v-tooltip"),V=c("v-container"),p=ve,w=de;return N(),G("div",fe,[s(V,{fluid:""},{default:o(()=>[s(i,null,{default:o(()=>[s(B,{cols:"12"},{default:o(()=>[T("div",be,[ye,s(E,{onClick:_[0]||(_[0]=r=>b.value=!0),width:"150px",height:"45px",color:"blue"},{default:o(()=>[D("Add Package")]),_:1})])]),_:1})]),_:1}),u.dashboardPackages?(N(),S(i,{key:0,class:"px-4"},{default:o(()=>[s(B,{cols:"12",class:"section_container dashboard_table"},{default:o(()=>[s(e(W),{headers:e(a),items:u.dashboardPackages.content,loading:u.loading,search:""},{"item.photo":o(({item:r})=>[T("div",$e,[T("img",{width:"100",height:"70",style:{"border-radius":"10px"},src:r.selectable.photo?`data:image/jpg;base64,${r.selectable.photo}`:"",alt:"Test Image"},null,8,he)])]),"item.latest":o(({item:r})=>[s(F,{color:$(r.selectable.latest)},{default:o(()=>[D(H(r.selectable.latest?"Yes":"No"),1)]),_:2},1032,["color"])]),"item.promoted":o(({item:r})=>[s(F,{color:$(r.selectable.promoted)},{default:o(()=>[D(H(r.selectable.promoted?"Yes":"No"),1)]),_:2},1032,["color"])]),"item.Tests":o(({item:r})=>[T("span",null,[s(k,{style:{cursor:"pointer"},color:"green"},{default:o(()=>[D("mdi-eye ")]),_:1}),s(v,{activator:"parent"},{default:o(()=>[s(n,{tests:r.selectable.tests},null,8,["tests"])]),_:2},1024)])]),"item.actions":o(({item:r})=>[s(k,{color:"blue",style:{cursor:"pointer"},onClick:L=>(A.value=r,y.value=!0)},{default:o(()=>[D("mdi-square-edit-outline")]),_:2},1032,["onClick"]),s(E,{elevation:"0",color:"transparent",loading:r.selectable.loading,ripple:!1},{default:o(()=>[s(k,{color:"red",style:{cursor:"pointer"},class:"ml-2",size:"23",onClick:L=>(R.value=r.selectable,h.value=!0)},{default:o(()=>[D("mdi-delete")]),_:2},1032,["onClick"])]),_:2},1032,["loading"])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1})):M("",!0)]),_:1}),e(y)?(N(),S(p,{key:0,openPopup:e(y),onClosePopup:_[1]||(_[1]=r=>(y.value=!1,A.value=null)),toUpdate:e(A),onRegetData:_[2]||(_[2]=r=>d("regetData"))},null,8,["openPopup","toUpdate"])):M("",!0),e(b)?(N(),S(p,{key:1,openPopup:e(b),onClosePopup:_[3]||(_[3]=r=>b.value=!1),onRegetData:_[4]||(_[4]=r=>d("regetData"))},null,8,["openPopup"])):M("",!0),e(h)?(N(),S(w,{key:2,openPopup:e(h),onClosePopup:_[5]||(_[5]=r=>h.value=!1),onConfirmDelete:m},null,8,["openPopup"])):M("",!0)])}}},Pe=ke,De={class:"dashboard_tests_page"},we={__name:"Packages",setup(u){const d=X(),{dashboardPackages:l}=z(d),b=f(!0),y=async()=>{b.value=!0,await d.doGetDashboardPackages(),b.value=!1};return Q(()=>{y()}),(h,A)=>{const R=Pe;return N(),G("div",De,[s(R,{dashboardPackages:e(l),loading:e(b),onRegetData:y},null,8,["dashboardPackages","loading"])])}}};export{we as default};
